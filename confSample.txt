worker_processes  1;

events {
    worker_connections  1024;
}

http {
    include       mime.types;
    default_type  application/octet-stream;
    sendfile        on;
    keepalive_timeout  65;

    server {
        listen 80;
        
        # Capture subdomain like project-1.localhost
        # server_name ~^(?<proj>project-[0-9]+)\.localhost$;
        server_name ~^(?<proj>[a-z0-9-]+)\.localhost$;

        # Base folder where all projects exist
        root "C:/Users/Rehan/Desktop/backup_coding/Projects/deployments/$proj/current";

        index index.html;

        # SPA handling for React
        location / {
            try_files $uri $uri/ /index.html;
        }

        location = /favicon.ico { 
            return 204; 
        }

        # Debug logs (optional)
        error_log "C:/nginx/logs/debug_error.log" debug;        
    }
}